### 3.6. Компьютерные сети, лекция 1
---
1.	Необязательное задание: можно посмотреть целый фильм в консоли telnet towel.blinkenlights.nl :)
Ничего не увидел
vshchepkin@vshchepkin:~$ telnet towel.blinkenlights.nl
Trying 213.136.8.188...

---
2.	Узнайте о том, сколько действительно независимых (не пересекающихся) каналов есть в разделяемой среде WiFi при работе на 2.4 ГГц. 
Стандарты с полосой 5 ГГц более актуальны, но регламенты на 5 ГГц существенно различаются в разных странах, а так же не раз обновлялись. 
В качестве дополнительного вопроса вне зачета, попробуйте найти актуальный ответ и на этот вопрос.

2.4 ГГц - 3 неперсекающихся канала, 1, 6, 11.

---
3.	Адрес канального уровня – MAC адрес – это 6 байт, первые 3 из которых называются OUI – Organizationally Unique Identifier или уникальный идентификатор организации.  
Какому производителю принадлежит MAC 38:f9:d3:55:55:79?
	
  Apple, Inc.

---
4.	Каким будет payload TCP сегмента, если Ethernet MTU задан в 9001 байт, размер заголовков IPv4 – 20 байт, а TCP – 32 байта?

9001 - 20 - 31 = 8949 байт
Размер Езернет заголовка, преамбулу, контрльную сумму не учитываем

---
5.	Может ли во флагах TCP одновременно быть установлены флаги SYN и FIN при штатном режиме работы сети? Почему да или нет?

Не могут, потому что это флаги начала и завершения сессии.

---
6.	ss -ula sport = :53 на хосте имеет следующий вывод:
State           Recv-Q          Send-Q                   Local Address:Port                     Peer Address:Port          Process
UNCONN          0               0                        127.0.0.53%lo:domain                        0.0.0.0:*
Почему в State присутствует только UNCONN, и может ли там присутствовать, например, TIME-WAIT?

UDP протокол с негарантированной доставкой, без установления предварительного соединения. Возможные состояние UNCONN или Established. 

---
7.	Обладая знаниями о том, как штатным образом завершается соединение (FIN от инициатора, FIN-ACK от ответчика, ACK от инициатора), опишите в каких состояниях  
будет находиться TCP соединение в каждый момент времени на клиенте и на сервере при завершении. Схема переходов состояния соединения вам в этом поможет.

Client - Estab -> Fin Wait1 -> Fin Wait2 -> Time Wait -> Closed  
Server - Estab -> Close Wait1 -> Close Wait2 -> Last ACK -> Closed

---
8.	TCP порт – 16 битное число. Предположим, 2 находящихся в одной сети хоста устанавливают между собой соединения. Каким будет теоретическое максимальное 
число соединений, ограниченное только лишь параметрами L4, которое параллельно может установить клиент с одного IP адреса к серверу с одним IP адресом? 
Сколько соединений сможет обслужить сервер от одного клиента? А если клиентов больше одного?

65535 соединений на один IP. Зависит, что такой клиент - IP или юзер ?! В первом случае на каждый IP по 65535, во втором случае юзеры могут находиться за натом, 
тогда на всех 65535 соединений.

---
9.	Может ли сложиться ситуация, при которой большое число соединений TCP на хосте находятся в состоянии TIME-WAIT? Если да, то является ли она хорошей или плохой?  
Подкрепите свой ответ пояснением той или иной оценки.

Может, если инициатором закрытия соединения будет выступать сам хост, а новые соединения будут создаваться быстрее, чем старые выходить из состояния TIME_Wait.
Ситуация плохая, так как это может привести к тому, что хост перестанет обслуживать новые соединения.

---
10.	Чем особенно плоха фрагментация UDP относительно фрагментации TCP?

В результате фрагментации увеличивается число фреймов, соответственно повышается вероятность того, что какой-то из них будет потерян, поврежден и т.п. А так как udp это протокол
с негарантированной доставкой, повторного завроса этого фрагмента не будет, в результате потеряем все сообщение.
При использовании TCP протокола отправляющая строна просто не получит подтвержения о том, что фрагмент доставлен, точнее диапазон фрагментов, которые были согласованы в окне, и
отправит эти фрагменты вновь.

---
11.	Если бы вы строили систему удаленного сбора логов, то есть систему, в которой несколько хостов отправяют на центральный узел генерируемые приложениями логи
(предположим, что логи – текстовая информация), какой протокол транспортного уровня вы выбрали бы и почему? Проверьте ваше предположение самостоятельно, узнав о 
стандартном протоколе syslog.

Я бы выбрал UDP, смысла нет отправлять, как правило, огромное число логов по tcp, потеря одного лога не критично, по сравнению с тем, что в сети будет бегать куча
SYN, ACK, FIN и т.п. служебных пакетов.

---
12.	Сколько портов TCP находится в состоянии прослушивания на вашей виртуальной машине с Ubuntu, и каким процессам они принадлежат?
```
root@vshchepkin:/# netstat -tupan | grep LISTEN | wc -l
5

root@vshchepkin:/# netstat -tupan
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      1006/nginx: master  
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      840/systemd-resolve 
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1024/sshd: /usr/sbi 
tcp        0    340 10.63.204.35:22         10.5.23.198:50101       ESTABLISHED 316398/sshd: vshche 
tcp6       0      0 :::80                   :::*                    LISTEN      1006/nginx: master  
tcp6       0      0 :::22                   :::*                    LISTEN      1024/sshd: /usr/sbi 
udp        0      0 127.0.0.53:53           0.0.0.0:*                           840/systemd-resolve 
udp        0      0 0.0.0.0:45694           0.0.0.0:*                           53904/avahi-daemon: 
udp        0      0 0.0.0.0:5353            0.0.0.0:*                           53904/avahi-daemon: 
udp6       0      0 :::44411                :::*                                53904/avahi-daemon: 
udp6       0      0 :::5353                 :::*                                53904/avahi-daemon:
```
Nginx, ssh, systemd-resolve

---
13.	Какой ключ нужно добавить в tcpdump, чтобы он начал выводить не только заголовки, но и содержимое фреймов в текстовом виде? А в текстовом и шестнадцатиричном?

Ключи -v, vv, vvv покажут содержимое пакета, разница в уровне детализации.
Ключ -А покажет информацию в текстовом виде, -X в шестнадцатиричном.

---
14.	Попробуйте собрать дамп трафика с помощью tcpdump на основном интерфейсе вашей виртуальной машины и посмотреть его через tshark или Wireshark (можно ограничить
число пакетов -c 100). Встретились ли вам какие-то установленные флаги Internet Protocol (не флаги TCP, а флаги IP)? Узнайте, какие флаги бывают. Как на самом 
деле называется стандарт Ethernet, фреймы которого попали в ваш дамп? Можно ли где-то в дампе увидеть OUI?

Ethernet описывается стандартом ieee 802.3

IP флаги
df указывает, что пакет не должен быть фрагментирован при передаче.

mf указывает, что пакет содержит еще фрагменты. Если не установлен, то фрагментов больше не осталовь.

rb указывает, что бит зарезервирован

Можно, первые 24 бита mac адреса это OUI.
